<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ” OTT ç­¾å + çŸ­ç½‘å€ç”Ÿæˆå™¨</title>
<style>
  body {
    font-family: system-ui, sans-serif;
    padding: 2em;
    max-width: 600px;
    margin: auto;
    background: radial-gradient(circle at top, #0a1a3a, #000);
    color: #fff;
  }
  h1 {
    text-align: center;
    background: linear-gradient(90deg, #00b7ff, #0078ff);
    -webkit-background-clip: text;
    color: transparent;
    font-size: 1.8em;
    font-weight: bold;
    margin-bottom: 1em;
    text-shadow: 0 0 12px #0078ff;
  }
  label { display: block; margin-top: 1em; font-weight: bold; }
  input, button {
    width: 100%;
    padding: .8em;
    margin-top: .5em;
    border-radius: 10px;
    border: 1px solid #0078ff;
    font-size: 1em;
  }
  input {
    background: #0d1b2a;
    color: #fff;
  }

  .generate-btn {
    background: linear-gradient(90deg, #ff004c, #ff7700);
    color: #fff;
    font-size: 1.1em;
    cursor: pointer;
    transition: 0.25s;
    border: none;
    box-shadow: 0 0 15px #ff3355;
  }
  .generate-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 25px #ff6600;
    background: linear-gradient(90deg, #ff6600, #ff0033);
  }

  pre {
    background: #0d1b2a;
    padding: 1em;
    border-radius: 10px;
    word-break: break-all;
    border: 1px solid #0078ff;
    margin-top: 0.5em;
  }

  .time-btns {
    display: flex;
    justify-content: space-between;
    margin-top: 1em;
    gap: 10px;
  }
  .time-btns button {
    flex: 1;
    background: linear-gradient(90deg, #0078ff, #00b7ff);
    border: none;
    box-shadow: 0 0 10px #0078ff;
    transition: 0.25s;
  }
  .time-btns button:hover {
    background: linear-gradient(90deg, #00b7ff, #0078ff);
    transform: scale(1.05);
  }

  footer {
    text-align: center;
    margin-top: 2.5em;
    font-size: 0.9em;
    color: #00e0ff;
    text-shadow: 0 0 12px #00e0ff;
    animation: glow 3s ease-in-out infinite alternate;
  }
  @keyframes glow {
    from { text-shadow: 0 0 8px #00e0ff, 0 0 16px #00e0ff; }
    to { text-shadow: 0 0 20px #ff004c, 0 0 40px #ff6600; color: #ffddcc; }
  }

  .hidden { display: none !important; }

  .lang-buttons {
    display: flex;
    justify-content: space-between;
    gap: 8px;
    margin-top: 1.5em;
  }
  .lang-buttons button {
    flex: 1;
    background: linear-gradient(90deg, #0078ff, #00b7ff);
    border: none;
    padding: 0.7em;
    border-radius: 10px;
    cursor: pointer;
    color: #fff;
    font-weight: bold;
    transition: 0.25s;
  }
  .lang-buttons button:hover {
    transform: scale(1.05);
    background: linear-gradient(90deg, #00b7ff, #0078ff);
  }
</style>
</head>
<body>

<h1>ğŸ” OTT é“¾æ¥ç­¾å + çŸ­ç½‘å€ç”Ÿæˆå™¨</h1>

<input id="secret" value="mySuperSecretKey" style="display:none">
<input id="domain" value="https://powertech.ott-1f4.workers.dev/" style="display:none">

<label>ç”¨æˆ· UID</label>
<input id="uid" placeholder="ä¾‹å¦‚ user123">

<label>è¿‡æœŸæ—¥æœŸæ—¶é—´ï¼ˆé©¬æ¥è¥¿äºšæ—¶é—´ï¼‰</label>
<input id="exp" type="datetime-local">

<div class="time-btns">
  <button type="button" onclick="setExpiryMonths(1)">ğŸ—“ï¸1ä¸ªæœˆ</button>
  <button type="button" onclick="setExpiryMonths(12)">ğŸ“† 1å¹´</button>
  <button type="button" onclick="setExpiryMonths(1200)">â™¾ï¸ æ°¸ä¹…</button>
</div>

<button class="generate-btn" onclick="generateFull()">ğŸš€ ç”Ÿæˆç­¾åå¹¶åˆ›å»ºçŸ­ç½‘å€</button>

<!-- âœ… ç­¾åé“¾æ¥æ”¹ä¸ºéšè— -->
<pre id="output" class="hidden"></pre>

<h3>ğŸ”— çŸ­ç½‘å€</h3>
<pre id="shortOutput">(ç”Ÿæˆä¸­...)</pre>
<button id="copyShortBtn" class="hidden" onclick="copyShortURL()">ğŸ“‹ å¤åˆ¶çŸ­ç½‘å€</button>
<button id="copyDescBtn" class="hidden" onclick="copyDescription()">ğŸ“„ å¤åˆ¶è¯´æ˜æ–‡å­—</button>

<div class="lang-buttons">
  <button onclick="toggleLang('cn')">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</button>
  <button onclick="toggleLang('en')">ğŸ‡¬ğŸ‡§ English</button>
  <button onclick="toggleLang('my')">ğŸ‡²ğŸ‡¾ Melayu</button>
</div>

<pre id="desc" class="hidden"></pre>

<footer>Â© 2025 @By PowerTech & Sky Mod</footer>

<script>
function getMalaysiaNow() {
  const now = new Date();
  return new Date(now.getTime() + 8 * 60 * 60 * 1000);
}
function setExpiryMonths(months) {
  const expInput = document.getElementById("exp");
  const malaysiaNow = getMalaysiaNow();
  if (months >= 1200) malaysiaNow.setFullYear(malaysiaNow.getFullYear() + 100);
  else malaysiaNow.setMonth(malaysiaNow.getMonth() + months);
  expInput.value = malaysiaNow.toISOString().slice(0,16);
}

async function hmacSHA256(text, secret) {
  const key = await crypto.subtle.importKey(
    "raw", new TextEncoder().encode(secret),
    { name: "HMAC", hash: "SHA-256" },
    false, ["sign"]
  );
  const sigBuf = await crypto.subtle.sign("HMAC", key, new TextEncoder().encode(text));
  return Array.from(new Uint8Array(sigBuf)).map(b => b.toString(16).padStart(2, "0")).join("");
}

async function generateFull() {
  try {
    const uid = document.getElementById("uid").value.trim();
    const secret = document.getElementById("secret").value.trim();
    const domain = document.getElementById("domain").value.trim();
    const expStr = document.getElementById("exp").value;
    if (!uid || !expStr) return;

    const expLocal = new Date(expStr);
    const expMillis = expLocal.getTime() - (new Date().getTimezoneOffset() * 60000);
    const text = `${uid}:${expMillis}`;
    const sig = await hmacSHA256(text, secret);
    const longURL = `${domain}?uid=${encodeURIComponent(uid)}&exp=${expMillis}&sig=${sig}`;
    document.getElementById("output").textContent = longURL; // âœ… éšè—ä½†ä»ä¿ç•™å€¼

    const res = await fetch("https://short.links-a15.workers.dev/", {
      method: "POST", headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ longURL })
    });
    const data = await res.json();

    if (data.shortURL) {
      document.getElementById("shortOutput").textContent = data.shortURL;
      document.getElementById("copyShortBtn").classList.remove('hidden');
      document.getElementById("copyDescBtn").classList.remove('hidden');
    }
  } catch (err) {
    console.error("Error:", err);
  }
}

function toggleLang(lang) {
  const shortURL = document.getElementById("shortOutput").textContent.trim();
  if (!shortURL || shortURL.includes("(ç”Ÿæˆä¸­")) {
    alert("è¯·å…ˆç”ŸæˆçŸ­ç½‘å€ï¼");
    return;
  }

  let text = "";
  if (lang === "cn") {
    text = `ğŸ‡¨ğŸ‡³ ä¸­æ–‡è¯´æ˜ï¼š

ğŸ“² ä¸‹è½½ä¸å®‰è£… OTT åº”ç”¨

åœ¨ Play å•†åº— (Play Store) 
æœç´¢å¹¶å®‰è£…ä»¥ä¸‹å…¶ä¸­ä¸€ä¸ªåº”ç”¨ï¼š

ğŸ”µ OTT TVï¼ˆç”µè§†ç‰ˆæœ¬ï¼‰
ğŸŸ¢ OTT PLAYERï¼ˆæ‰‹æœºç‰ˆæœ¬ï¼‰

âš ï¸ åªéœ€ä¸‹è½½å…¶ä¸­ä¸€ä¸ªå³å¯ï¼

---

ğŸ§­ ä½¿ç”¨æ­¥éª¤ï¼š

1. æ‰“å¼€ OTT Player / TV åº”ç”¨
2. ç‚¹å‡»å³ä¸Šè§’ è®¾ç½® (Settings) å›¾æ ‡
3. é€‰æ‹© Providerï¼ˆä¾›åº”å•†ï¼‰
4. ç‚¹å‡» Add Providerï¼ˆæ·»åŠ ä¾›åº”å•†ï¼‰
5. é€‰æ‹© Playlistï¼ˆæ’­æ”¾åˆ—è¡¨ï¼‰
6. è¾“å…¥ä»¥ä¸‹ URL å¹¶ç‚¹å‡» Applyï¼ˆåº”ç”¨ï¼‰

ğŸ“Œ âœ… 1 ä¸ªé“¾æ¥ä»…é™ 1 å°è®¾å¤‡ä½¿ç”¨ï¼
ğŸ‘‡ğŸ‘‡URL é“¾æ¥ğŸ‘‡ğŸ‘‡
ğŸ‘‰ ${shortURL}

âš ï¸ â›”ï¸ åŒä¸€é“¾æ¥å¤šè®¾å¤‡ä½¿ç”¨å°†ä¼šè‡ªåŠ¨å°ç¦ï¼`;
  } else if (lang === "en") {
    text = `ğŸ‡¬ğŸ‡§ English Instructions:

ğŸ“² Download & Install OTT App

Go to Play Store and search for OTT. 
Download one of the following apps:

ğŸ”µ OTT TV (for TV version)
ğŸŸ¢ OTT PLAYER (for mobile version)

âš ï¸ Download only ONE of them!

---

ğŸ§­ Setup Steps:

1. Open OTT Player / TV app
2. Tap the Settings icon
3. Select Provider
4. Tap Add Provider
5. Choose Playlist
6. Enter the URL below and click Apply

ğŸ“Œ âœ… 1 URL for 1 Device Only!
ğŸ‘‡ğŸ‘‡ URL Account Link ğŸ‘‡ğŸ‘‡
ğŸ‘‰ ${shortURL}

âš ï¸ â›”ï¸ If used on multiple devices,
      it will be auto-banned!`;
  } else {
    text = `ğŸ‡²ğŸ‡¾ Bahasa Melayu:

ğŸ“² Muat Turun & Pasang Aplikasi OTT

Buka Play Store, cari â€œOTTâ€ dan pasang 
salah satu aplikasi berikut:

ğŸ”µ OTT TV (TV version)
ğŸŸ¢ OTT PLAYER (Android phone)

âš ï¸ Muat turun salah satu sahaja!

---

ğŸ§­ Langkah Penggunaan:

1. Buka aplikasi OTT Player / TV
2. Tekan ikon Tetapan (Settings)
3. Pilih Provider (Penyedia)
4. Tekan Add Provider (Tambah Penyedia)
5. Pilih Playlist (Senarai Main)
6. Masukkan URL di bawah dan tekan Apply (Guna)

ğŸ“Œ âœ… 1 URL hanya untuk 1 peranti sahaja!
ğŸ‘‡ğŸ‘‡ Pautan Akaun URL ğŸ‘‡ğŸ‘‡
ğŸ‘‰ ${shortURL}

âš ï¸ â›”ï¸ Jika digunakan pada lebih daripada 
      satu peranti, akaun akan diharamkan 
      secara automatik!`;
  }

  const desc = document.getElementById("desc");
  desc.textContent = text;
  desc.classList.remove("hidden");
}

async function copyShortURL() {
  const text = document.getElementById("shortOutput").textContent.trim();
  try { await navigator.clipboard.writeText(text); } catch {}
}

async function copyDescription() {
  const text = document.getElementById("desc").textContent.trim();
  if (!text) return;
  try { await navigator.clipboard.writeText(text); } catch {}
}
</script>
</body>
</html>
